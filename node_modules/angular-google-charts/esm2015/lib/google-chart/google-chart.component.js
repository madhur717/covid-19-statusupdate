/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/// <reference types="google.visualization"/>
/// <reference types="google.visualization"/>
import { Component, ElementRef, Input, ChangeDetectionStrategy } from '@angular/core';
import { ScriptLoaderService } from '../script-loader/script-loader.service';
import { RawChartComponent } from '../raw-chart/raw-chart.component';
import * as ɵngcc0 from '@angular/core';
export class GoogleChartComponent extends RawChartComponent {
    /**
     * @param {?} element
     * @param {?} loaderService
     */
    constructor(element, loaderService) {
        super(element, loaderService);
        this.roles = new Array();
        this.width = undefined;
        this.height = undefined;
        this.options = {};
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (this.type == null) {
            throw new Error('Can\'t create a Google Chart without specifying a type!');
        }
        if (this.data == null) {
            throw new Error('Can\'t create a Google Chart without data!');
        }
        this.chartData = {
            chartType: this.type
        };
        this.loaderService.onReady.subscribe((/**
         * @return {?}
         */
        () => {
            this.createChart();
        }));
    }
    /**
     * @return {?}
     */
    ngOnChanges() {
        if (this.wrapper) {
            this.chartData = {
                chartType: this.type,
                dataTable: this.getDataTable(),
                options: this.parseOptions()
            };
        }
        super.ngOnChanges();
    }
    /**
     * @protected
     * @return {?}
     */
    parseOptions() {
        return Object.assign({ title: this.title, width: this.width, height: this.height }, this.options);
    }
    /**
     * @protected
     * @return {?}
     */
    createChart() {
        this.loadNeededPackages().subscribe((/**
         * @return {?}
         */
        () => {
            this.chartData = {
                chartType: this.type,
                dataTable: this.getDataTable(),
                options: this.parseOptions()
            };
            this.wrapper = new google.visualization.ChartWrapper();
            this.updateChart();
        }));
    }
    /**
     * @protected
     * @return {?}
     */
    getDataTable() {
        if (this.columnNames) {
            /** @type {?} */
            const columns = this.parseRoles(this.columnNames);
            this.firstRowIsData = false;
            return [columns, ...this.data];
        }
        else {
            this.firstRowIsData = true;
            return this.data;
        }
    }
    /**
     * @private
     * @param {?} columnNames
     * @return {?}
     */
    parseRoles(columnNames) {
        /** @type {?} */
        const columnNamesWithRoles = columnNames.slice();
        if (this.roles) {
            // Roles must be copied to avoid modifying the index everytime there's a change from ngOnChanges.
            /** @type {?} */
            const copyRoles = this.roles.map((/**
             * @param {?} role
             * @return {?}
             */
            role => Object.assign({}, role)));
            copyRoles.forEach((/**
             * @param {?} role
             * @return {?}
             */
            role => {
                /** @type {?} */
                const roleData = {
                    type: role.type,
                    role: role.role
                };
                if (role.p) {
                    roleData.p = role.p;
                }
                if (role.index != null) {
                    columnNamesWithRoles.splice(role.index + 1, 0, roleData);
                    for (const otherRole of copyRoles) {
                        if (otherRole === role) {
                            continue;
                        }
                        if (otherRole.index > role.index) {
                            otherRole.index++;
                        }
                    }
                }
                else {
                    columnNamesWithRoles.push(roleData);
                }
            }));
        }
        return columnNamesWithRoles;
    }
}
GoogleChartComponent.ɵfac = function GoogleChartComponent_Factory(t) { return new (t || GoogleChartComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ScriptLoaderService)); };
GoogleChartComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: GoogleChartComponent, selectors: [["google-chart"]], inputs: { roles: "roles", width: "width", height: "height", options: "options", data: "data", columnNames: "columnNames", title: "title", type: "type" }, exportAs: ["google-chart"], features: [ɵngcc0.ɵɵInheritDefinitionFeature, ɵngcc0.ɵɵNgOnChangesFeature], decls: 0, vars: 0, template: function GoogleChartComponent_Template(rf, ctx) { }, styles: ["[_nghost-%COMP%] { width: fit-content; display: block; }"], changeDetection: 0 });
/** @nocollapse */
GoogleChartComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: ScriptLoaderService }
];
GoogleChartComponent.propDecorators = {
    data: [{ type: Input }],
    columnNames: [{ type: Input }],
    roles: [{ type: Input }],
    title: [{ type: Input }],
    width: [{ type: Input }],
    height: [{ type: Input }],
    options: [{ type: Input }],
    type: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(GoogleChartComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: 'google-chart',
                template: '',
                exportAs: 'google-chart',
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: [':host { width: fit-content; display: block; }']
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ScriptLoaderService }]; }, { roles: [{
            type: Input
        }], width: [{
            type: Input
        }], height: [{
            type: Input
        }], options: [{
            type: Input
        }], data: [{
            type: Input
        }], columnNames: [{
            type: Input
        }], title: [{
            type: Input
        }], type: [{
            type: Input
        }] }); })();
if (false) {
    /** @type {?} */
    GoogleChartComponent.prototype.data;
    /** @type {?} */
    GoogleChartComponent.prototype.columnNames;
    /** @type {?} */
    GoogleChartComponent.prototype.roles;
    /** @type {?} */
    GoogleChartComponent.prototype.title;
    /** @type {?} */
    GoogleChartComponent.prototype.width;
    /** @type {?} */
    GoogleChartComponent.prototype.height;
    /** @type {?} */
    GoogleChartComponent.prototype.options;
    /** @type {?} */
    GoogleChartComponent.prototype.type;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ29vZ2xlLWNoYXJ0LmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsibmc6L2FuZ3VsYXItZ29vZ2xlLWNoYXJ0cy9saWIvZ29vZ2xlLWNoYXJ0L2dvb2dsZS1jaGFydC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLDZDQUE2QztBQUM3QztBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQVUsVUFBVSxFQUFFLEtBQUssRUFBRSx1QkFBdUIsRUFBYSxNQUFNLGVBQWUsQ0FBQztBQUV6RyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUM3RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQzs7QUFXckUsTUFBTSxPQUFPLG9CQUFxQixTQUFRLGlCQUFpQjtBQUFHO0FBQVE7QUFDakU7QUFDcUI7QUFBUSxJQXVCaEMsWUFBWSxPQUFtQixFQUFFLGFBQWtDO0FBQ3JFLFFBQUksS0FBSyxDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQztBQUNsQyxRQW5CRSxVQUFLLEdBQWdCLElBQUksS0FBSyxFQUFFLENBQUM7QUFDbkMsUUFLRSxVQUFLLEdBQVcsU0FBUyxDQUFDO0FBQzVCLFFBRUUsV0FBTSxHQUFXLFNBQVMsQ0FBQztBQUM3QixRQUVFLFlBQU8sR0FBUSxFQUFFLENBQUM7QUFDcEIsSUFNRSxDQUFDO0FBQ0g7QUFDTztBQUNJO0FBQVEsSUFEakIsUUFBUTtBQUNWLFFBQUksSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksRUFBRTtBQUMzQixZQUFNLE1BQU0sSUFBSSxLQUFLLENBQUMseURBQXlELENBQUMsQ0FBQztBQUNqRixTQUFLO0FBQ0wsUUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxFQUFFO0FBQzNCLFlBQU0sTUFBTSxJQUFJLEtBQUssQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO0FBQ3BFLFNBQUs7QUFDTCxRQUNJLElBQUksQ0FBQyxTQUFTLEdBQUc7QUFD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QSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFuSUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRkEsQUFBQSxBQUdBLEFBYkEsQUFBQSxBQUVBLEFBQUEsQUFhQSxBQUFBLEFBR0EsQUFBQSxBQUdBLEFBQUEsQUFHQSxBQUFBLEFBR0EsQUFBQSxBQUdBLEFBQUEsQUFHQSxBQUFBLEFBR0EsQUFBQSxBQXJCQSxBQUNBLEFBRUEsQUFDQSxBQUVBLEFBQ0EsQUFFQSxBQUNBLEFBRUEsQUFDQSxBQUVBLEFBQ0EsQUFFQSxBQUNBLEFBRUEsQUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHR5cGVzPVwiZ29vZ2xlLnZpc3VhbGl6YXRpb25cIi8+XHJcblxyXG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgRWxlbWVudFJlZiwgSW5wdXQsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBPbkNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmltcG9ydCB7IFNjcmlwdExvYWRlclNlcnZpY2UgfSBmcm9tICcuLi9zY3JpcHQtbG9hZGVyL3NjcmlwdC1sb2FkZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IFJhd0NoYXJ0Q29tcG9uZW50IH0gZnJvbSAnLi4vcmF3LWNoYXJ0L3Jhdy1jaGFydC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBSb2xlIH0gZnJvbSAnLi4vbW9kZWxzL3JvbGUubW9kZWwnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxyXG4gIHNlbGVjdG9yOiAnZ29vZ2xlLWNoYXJ0JyxcclxuICB0ZW1wbGF0ZTogJycsXHJcbiAgc3R5bGVzOiBbJzpob3N0IHsgd2lkdGg6IGZpdC1jb250ZW50OyBkaXNwbGF5OiBibG9jazsgfSddLFxyXG4gIGV4cG9ydEFzOiAnZ29vZ2xlLWNoYXJ0JyxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxyXG59KVxyXG5leHBvcnQgY2xhc3MgR29vZ2xlQ2hhcnRDb21wb25lbnQgZXh0ZW5kcyBSYXdDaGFydENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuICBASW5wdXQoKVxyXG4gIGRhdGE6IEFycmF5PEFycmF5PHN0cmluZyB8IG51bWJlcj4+O1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGNvbHVtbk5hbWVzOiBBcnJheTxzdHJpbmc+O1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHJvbGVzOiBBcnJheTxSb2xlPiA9IG5ldyBBcnJheSgpO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHRpdGxlOiBzdHJpbmc7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgd2lkdGg6IG51bWJlciA9IHVuZGVmaW5lZDtcclxuXHJcbiAgQElucHV0KClcclxuICBoZWlnaHQ6IG51bWJlciA9IHVuZGVmaW5lZDtcclxuXHJcbiAgQElucHV0KClcclxuICBvcHRpb25zOiBhbnkgPSB7fTtcclxuXHJcbiAgQElucHV0KClcclxuICB0eXBlOiBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQ6IEVsZW1lbnRSZWYsIGxvYWRlclNlcnZpY2U6IFNjcmlwdExvYWRlclNlcnZpY2UpIHtcclxuICAgIHN1cGVyKGVsZW1lbnQsIGxvYWRlclNlcnZpY2UpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICBpZiAodGhpcy50eXBlID09IG51bGwpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5cXCd0IGNyZWF0ZSBhIEdvb2dsZSBDaGFydCB3aXRob3V0IHNwZWNpZnlpbmcgYSB0eXBlIScpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuZGF0YSA9PSBudWxsKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2FuXFwndCBjcmVhdGUgYSBHb29nbGUgQ2hhcnQgd2l0aG91dCBkYXRhIScpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY2hhcnREYXRhID0ge1xyXG4gICAgICBjaGFydFR5cGU6IHRoaXMudHlwZVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmxvYWRlclNlcnZpY2Uub25SZWFkeS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICB0aGlzLmNyZWF0ZUNoYXJ0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKCkge1xyXG4gICAgaWYgKHRoaXMud3JhcHBlcikge1xyXG4gICAgICB0aGlzLmNoYXJ0RGF0YSA9IHtcclxuICAgICAgICBjaGFydFR5cGU6IHRoaXMudHlwZSxcclxuICAgICAgICBkYXRhVGFibGU6IHRoaXMuZ2V0RGF0YVRhYmxlKCksXHJcbiAgICAgICAgb3B0aW9uczogdGhpcy5wYXJzZU9wdGlvbnMoKVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHN1cGVyLm5nT25DaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgcGFyc2VPcHRpb25zKCk6IGFueSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0aXRsZTogdGhpcy50aXRsZSxcclxuICAgICAgd2lkdGg6IHRoaXMud2lkdGgsXHJcbiAgICAgIGhlaWdodDogdGhpcy5oZWlnaHQsXHJcbiAgICAgIC4uLnRoaXMub3B0aW9uc1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBjcmVhdGVDaGFydCgpIHtcclxuICAgIHRoaXMubG9hZE5lZWRlZFBhY2thZ2VzKCkuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgdGhpcy5jaGFydERhdGEgPSB7XHJcbiAgICAgICAgY2hhcnRUeXBlOiB0aGlzLnR5cGUsXHJcbiAgICAgICAgZGF0YVRhYmxlOiB0aGlzLmdldERhdGFUYWJsZSgpLFxyXG4gICAgICAgIG9wdGlvbnM6IHRoaXMucGFyc2VPcHRpb25zKClcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRoaXMud3JhcHBlciA9IG5ldyBnb29nbGUudmlzdWFsaXphdGlvbi5DaGFydFdyYXBwZXIoKTtcclxuICAgICAgdGhpcy51cGRhdGVDaGFydCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgZ2V0RGF0YVRhYmxlKCk6IEFycmF5PGFueT4ge1xyXG4gICAgaWYgKHRoaXMuY29sdW1uTmFtZXMpIHtcclxuICAgICAgY29uc3QgY29sdW1ucyA9IHRoaXMucGFyc2VSb2xlcyh0aGlzLmNvbHVtbk5hbWVzKTtcclxuICAgICAgdGhpcy5maXJzdFJvd0lzRGF0YSA9IGZhbHNlO1xyXG4gICAgICByZXR1cm4gW2NvbHVtbnMsIC4uLnRoaXMuZGF0YV07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmZpcnN0Um93SXNEYXRhID0gdHJ1ZTtcclxuICAgICAgcmV0dXJuIHRoaXMuZGF0YTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcGFyc2VSb2xlcyhjb2x1bW5OYW1lczogYW55W10pOiBhbnlbXSB7XHJcbiAgICBjb25zdCBjb2x1bW5OYW1lc1dpdGhSb2xlcyA9IGNvbHVtbk5hbWVzLnNsaWNlKCk7XHJcbiAgICBpZiAodGhpcy5yb2xlcykge1xyXG4gICAgICAvLyBSb2xlcyBtdXN0IGJlIGNvcGllZCB0byBhdm9pZCBtb2RpZnlpbmcgdGhlIGluZGV4IGV2ZXJ5dGltZSB0aGVyZSdzIGEgY2hhbmdlIGZyb20gbmdPbkNoYW5nZXMuXHJcbiAgICAgIGNvbnN0IGNvcHlSb2xlcyA9IHRoaXMucm9sZXMubWFwKHJvbGUgPT4gT2JqZWN0LmFzc2lnbih7fSwgcm9sZSkpO1xyXG4gICAgICBjb3B5Um9sZXMuZm9yRWFjaChyb2xlID0+IHtcclxuICAgICAgICBjb25zdCByb2xlRGF0YTogUm9sZSA9IHtcclxuICAgICAgICAgIHR5cGU6IHJvbGUudHlwZSxcclxuICAgICAgICAgIHJvbGU6IHJvbGUucm9sZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKHJvbGUucCkge1xyXG4gICAgICAgICAgcm9sZURhdGEucCA9IHJvbGUucDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJvbGUuaW5kZXggIT0gbnVsbCkge1xyXG4gICAgICAgICAgY29sdW1uTmFtZXNXaXRoUm9sZXMuc3BsaWNlKHJvbGUuaW5kZXggKyAxLCAwLCByb2xlRGF0YSk7XHJcblxyXG4gICAgICAgICAgZm9yIChjb25zdCBvdGhlclJvbGUgb2YgY29weVJvbGVzKSB7XHJcbiAgICAgICAgICAgIGlmIChvdGhlclJvbGUgPT09IHJvbGUpIHtcclxuICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG90aGVyUm9sZS5pbmRleCA+IHJvbGUuaW5kZXgpIHtcclxuICAgICAgICAgICAgICBvdGhlclJvbGUuaW5kZXgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb2x1bW5OYW1lc1dpdGhSb2xlcy5wdXNoKHJvbGVEYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjb2x1bW5OYW1lc1dpdGhSb2xlcztcclxuICB9XHJcbn1cclxuIl19